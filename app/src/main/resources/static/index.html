<!doctype html>
<html>
<head>
<title>Banco dei crediti del SOS</title>

<link rel="stylesheet"
	href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
	integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk"
	crossorigin="anonymous">
	<script type="text/javascript" src="https://code.jquery.com/jquery-1.7.1.min.js"></script>
</head>
<body>
	<div class="container">
		<h2 id="titolo">Elenco Conti</h2>
		<table class="table">
			<thead>
				<tr>
					<th scope="col">ID</th>
					<th scope="col">Nome</th>
					<th scope="col">Cognome</th>
					<th scope="col"></th>
				</tr>
			</thead>
			<tbody id="elenco">
			
			
			</tbody>
			
		</table>
	</div>
	
		<div class="container">
		<h2 id="titolo">Elenco Trasferimenti</h2>
		<table class="table">
			<thead>
				<tr>
					<th scope="col">ID</th>
					<th scope="col">ID Mittente</th>
					<th scope="col">ID Destinatario</th>
					<th scope="col">Importo</th>
				</tr>
			</thead>
			<tbody id="elencoTransaction">
			</tbody>
			
		</table>

		<form>
			<p> Nome : <input type="text" id="name1"> </p>
			<p> Cognome : <input type="text" id="surname"> </p>
			<p> <button  name="invio" value="Invio Dati" onclick="createAccount(name1.value, surname.value)">Crea Nuovo account </button> </p>
		</form>
		
		
		<form>
			<p> id : <input type="text" id="idaccount"> </p>
			<p> <button  name="invioID" onclick="getInfo(idaccount.value)">Richiedi dati </button> </p>
		</form>
		
		<h2 id="titolo">Dati account</h2>
		<table class="table">
			<thead>
				<tr>
					<th scope="col">ID</th>
					<th scope="col">Nome</th>
					<th scope="col">Cognome</th>
					<th scope="col">Saldo</th>
				</tr>
			</thead>
			<tbody id="Datiaccountrichiesto">
			</tbody>
		


	</div>

	<script>	
		$.getJSON("http://localhost:8080/api/transaction", 	function(data, status)
		{
			var s = "";
			
			for(const element of data)
			{
				s = s+"<tr><td>"+element.id+"</td><td>"+element.sender+"</td><td>"+element.recipient +"</td><td>"+element.amount +"</td></tr>";
			}
		
			document.getElementById("elencoTransaction").innerHTML = s;
			
		});
		
		
	</script>
	
	<script>	
		$.getJSON("http://localhost:8080/api/account", 	function(data, status)
		{
			var s = "";
			
			for(const element of data)
			{
				s = s+"<tr><td>"+element.id+"</td><td>"+element.name+"</td><td>"+element.surname +"</td><td><button onclick=\"deleteAccount('"+element.id+"')\">Elimina </button> </td></tr>";
			}
		
			document.getElementById("elenco").innerHTML = s;
			
		});
	</script>
	
	<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
		integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
		crossorigin="anonymous"></script>
	<script
		src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
		integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
		crossorigin="anonymous"></script>
	<script
		src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
		integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
		crossorigin="anonymous"></script>
	<script
		src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"
		type="text/javascript"></script>
		
	
</body>
<script>

function deleteAccount(id)
{
	
    $.ajax({
        url: '/api/'+id,

        type: 'DELETE',
        success: function(result) {
            window.location.reload();
        }
    });
}

function createAccount(name1,surname1)
{
	
    $.post("/api/account",
    {
        name: name1,
        surname: surname1,
		success: function(result) {
            window.location.reload();
        }
    })
}

function getInfo(id){

	$.ajax({
        url: '/api/account/'+id,

        type: 'GET',
        success: function(result) {
            var s = "<tr><td>"+result.id+"</td><td>"+result.name+"</td><td>"+result.surname +"</td><td>"+result.balance +"</td></tr>";
            document.getElementById("Datiaccountrichiesto").innerHTML = "ciao a tutti";
        }
    });


  
}




</script>
</html>